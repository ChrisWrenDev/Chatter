(this.webpackJsonpChatter=this.webpackJsonpChatter||[]).push([[0],{21:function(e,t,n){e.exports={message:"Message_message__33FPt",user__message:"Message_user__message__TOOZ_",target__message:"Message_target__message__kFY1V",message__text:"Message_message__text__3dJN9",message__timer:"Message_message__timer__2JdJ5"}},26:function(e,t,n){e.exports={header:"Header_header__10Yca",header__logo:"Header_header__logo__1i0Rm"}},32:function(e,t,n){e.exports={login__form:"User_login__form__Pr11S",login__btn:"User_login__btn__3KX5D",logout__btn:"User_logout__btn__2wdew"}},33:function(e,t,n){e.exports={messages__container:"MessageList_messages__container__15i2T",messages__feed:"MessageList_messages__feed__3qv31"}},47:function(e,t,n){e.exports={form:"Login_form__2VD1G"}},49:function(e,t,n){e.exports={connect__btn:"Target_connect__btn__3RT8G"}},50:function(e,t,n){e.exports={chatForm:"ChatForm_chatForm__3xNu0"}},51:function(e,t,n){e.exports={chat:"Chat_chat__1MKgb"}},69:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),c=n(23),r=n.n(c),o=n(53),i=n(7),u=n(6),l=n(17),j=Object(l.b)({name:"login",initialState:{userName:"",userTimer:0,userStatus:"",targetName:"",targetStatus:""},reducers:{setUserTimer:function(e,t){e.userTimer=t.payload},setUserName:function(e,t){e.userName=t.payload},setUserStatus:function(e,t){e.userStatus=t.payload,console.log("User Status: "+t.payload)},setTargetUsername:function(e,t){e.targetName=t.payload},setTargetStatus:function(e,t){e.targetStatus=t.payload,console.log("Target Status: "+t.payload)}}}),b=j.actions,d=j.reducer,g=Object(l.b)({name:"chat",initialState:{chatDuration:0,messages:[]},reducers:{addMessage:function(e,t){e.messages.push({id:e.messages.length++,user:t.payload.user,interval:t.payload.interval,message:t.payload.message})},removeMessage:function(e,t){e.messages=e.messages.filter((function(e){return e.id!==t.payload}))},updateChatDuration:function(e,t){e.chatDuration=t.payload}}}),m=g.actions,f=g.reducer,_=n(45),O=n.n(_),h=n(1),x=Object(a.createContext)({userConnection:null,targetConnection:null,connectUser:function(){},reconnectUser:function(){},disconnectUser:function(){},connectTarget:function(){},disconnectTarget:function(){}}),p=function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),s=n[0],c=n[1],r=Object(a.useState)(null),l=Object(i.a)(r,2),j=l[0],d=l[1],g=Object(a.useState)([]),f=Object(i.a)(g,2),_=f[0],p=f[1],v=Object(u.b)(),S=Object(u.c)((function(e){return e.login.userName})),T=Object(u.c)((function(e){return e.login.userTimer}));Object(a.useEffect)((function(){null!==s&&(s.on("open",(function(e){v(b.setUserStatus("open"))})),s.on("connection",(function(e){console.log(e),p((function(t){return[].concat(Object(o.a)(t),[e])}))})),s.on("close",(function(){v(b.setUserStatus("close"))})),s.on("disconnected",(function(){v(b.setUserStatus("disconnected"))})),s.on("error",(function(e){switch(e.type){case"browser-incompatible":v(b.setUserStatus("Not compatible with browser"));break;case"disconnected":v(b.setUserStatus("disconnected"));break;case"invalid-id":case"invalid-key":case"peer-unavailable":v(b.setTargetStatus("Target is unavailable"));break;case"unavailable-id":v(b.setUserStatus("Username is already taken"));break;case"network":case"server-error":case"socket-error":case"socket-closed":case"webrtc":v(b.setUserStatus("Something went wrong"))}})))}),[s,v]);Object(a.useEffect)((function(){null!==j&&(j.on("data",(function(e){console.log("Message Recieved"),v(m.addMessage(e))})),j.on("open",(function(){v(b.setTargetStatus("connection"))})),j.on("close",(function(){v(b.setTargetStatus("close"))})),j.on("error",(function(e){v(b.setTargetStatus("error"))})))}),[j,v]);return Object(h.jsx)(x.Provider,{value:{userConnection:s,targetConnection:j,connectUser:function(e,t){c(new O.a(e)),v(b.setUserName(e)),v(b.setUserTimer(t))},reconnectUser:function(){s.reconnect()},disconnectUser:function(){s.destroy()},connectTarget:function(e){b.setTargetUsername(e);var t=_.findIndex((function(t){return t.peer===e}));console.log(t),-1!==t?(d(_[t]),v(b.setTargetStatus("connection"))):d(s.connect(e))},disconnectTarget:function(){j.close()},sendMessage:function(e){j.send({user:S,interval:T,message:e}),v(m.addMessage({message:e,interval:T})),console.log("Message Sent: "+e)}},children:e.children})},v=x,S=Object(l.a)({reducer:{login:d,chat:f}}),T=(n(69),n(70),n(18)),U=n(47),N=n.n(U),y=n(8),C=n(14),M=n(48),k=function(e){return Object(h.jsxs)(y.a.Group,{className:"mb-3",controlId:"formUsername",children:[Object(h.jsx)(M.a,{controlId:"floatingUsername",label:"Username",children:Object(h.jsx)(y.a.Control,{type:"text",name:"username",value:e.value,placeholder:"Enter username",onChange:e.usernameHandler})}),Object(h.jsx)(y.a.Control.Feedback,{type:e.error,children:e.error})]})},w=function(e){return Object(h.jsx)(y.a.Group,{className:"mb-3",controlId:"formTimeout",children:Object(h.jsx)(M.a,{controlId:"floatingSelect",label:"Timer",children:Object(h.jsxs)(y.a.Select,{onChange:e.intervalHandler,children:[Object(h.jsx)("option",{value:"5",children:"5 seconds"}),Object(h.jsx)("option",{value:"10",children:"10 seconds"}),Object(h.jsx)("option",{value:"15",children:"15 seconds"})]})})})},F=n(32),E=n.n(F),D=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)(""),r=Object(i.a)(c,2),o=r[0],l=r[1],j=Object(a.useState)("login"),b=Object(i.a)(j,2),d=b[0],g=b[1],m=Object(a.useState)(""),f=Object(i.a)(m,2),_=f[0],O=f[1],x=Object(u.c)((function(e){return e.login.userName})),p=Object(u.c)((function(e){return e.login.userStatus})),S=Object(u.c)((function(e){return e.login.userError})),T=Object(a.useContext)(v);Object(a.useEffect)((function(){O(S)}),[S]),Object(a.useEffect)((function(){""!==x&&s(x)}),[x]),Object(a.useEffect)((function(){switch(p){case"":case"close":case"error":g("login");break;case"open":case"connection":g("logout");break;case"disconnected":g("reconnect")}}),[p]);return Object(h.jsxs)(y.a,{onSubmit:function(e){e.preventDefault(),""!==n?"login"===d?T.connectUser(n,o):"logout"===d?T.disconnectUser():"reconnect"===d&&T.reconnectUser():O("Please enter username")},className:E.a.login__form,children:[Object(h.jsx)(k,{value:n,error:_,usernameHandler:function(e){s(e.target.value)}}),Object(h.jsx)(w,{intervalHandler:function(e){l(e.target.value)}}),Object(h.jsx)(C.a,{className:E.a["".concat(d,"__btn")],variant:"primary",type:"submit",children:d})]})},H=function(e){return Object(h.jsx)(y.a.Group,{className:"mb-3",controlId:"formTarget",children:Object(h.jsx)(M.a,{controlId:"floatingTarget",label:"Target",children:Object(h.jsx)(y.a.Control,{type:"text",placeholder:"Target username",value:e.value,onChange:e.targetUsernameHandler})})})},I=n(49),P=n.n(I),L=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],c=Object(u.c)((function(e){return e.login.targetName})),r=Object(u.c)((function(e){return e.login.targetError}));Object(a.useEffect)((function(){s(c)}),[c]);var o=Object(a.useContext)(v);return Object(h.jsxs)(y.a,{onSubmit:function(e){e.preventDefault(),o.connectTarget(n)},children:[Object(h.jsx)(H,{value:n,error:r,targetUsernameHandler:function(e){s(e.target.value)}}),Object(h.jsx)(C.a,{className:P.a.connect__btn,variant:"secondary",type:"submit",children:"Connect"}),Object(h.jsx)(y.a.Control.Feedback,{type:r,children:r})]})},G=function(){return Object(h.jsxs)(T.a,{className:N.a.form,children:[Object(h.jsx)(D,{}),Object(h.jsx)(L,{})]})},J=n(26),R=n.n(J),B=function(){var e=Object(a.useContext)(v),t=Object(u.b)(),n=Object(u.c)((function(e){return e.login.userTimer}));return Object(h.jsxs)("div",{className:R.a.header,children:[Object(h.jsx)("div",{className:R.a.header__logo,children:"Logo"}),Object(h.jsx)(w,{value:n,intervalHandler:function(e){t(b.setUserTimer(e.target.value))}}),Object(h.jsx)(C.a,{className:R.a.header__btn,variant:"primary",type:"button",onClick:function(){e.disconnectTarget()},children:"Disconnect"})]})},K=n(54),V=n(21),Y=n.n(V),q=n(52),A=function(e){var t=e.id,n=e.user,s=e.message,c=e.interval,r=Object(a.useState)(0),o=Object(i.a)(r,2),l=o[0],j=o[1],b=Object(a.useState)(0),d=Object(i.a)(b,2),g=d[0],f=d[1],_=Object(u.c)((function(e){return e.login.userName})),O=Object(u.b)(),x=n===_?"user":"target";return Object(a.useEffect)((function(){l<c?setTimeout((function(){j((function(e){return e+.1})),f(l/c*100)}),100):O(m.removeMessage(t))}),[l,c,t,O]),Object(h.jsxs)(T.a,{className:Y.a.message,children:[Object(h.jsx)(q.a,{className:Y.a["".concat(x,"__mesage")]}),Object(h.jsx)("p",{className:Y.a.message__text,children:s}),Object(h.jsx)(K.a,{now:g,className:Y.a.message__timer})]})},X=n(33),Z=n.n(X),z=function(){var e=Object(u.c)((function(e){return e.chat.messages}));return Object(h.jsx)("div",{className:Z.a.messages__container,children:Object(h.jsx)("div",{className:Z.a.messages__feed,children:e.map((function(e){return Object(h.jsx)(A,{id:e.id,user:e.user,message:e.message,interval:e.interval},e.id)}))})})},Q=n(50),W=n.n(Q),$=function(){var e=Object(a.useState)(""),t=Object(i.a)(e,2),n=t[0],s=t[1],c=Object(a.useContext)(v);return Object(h.jsxs)(y.a,{onSubmit:function(e){e.preventDefault(),c.sendMessage(n),s("")},className:W.a.chatForm,children:[Object(h.jsx)(y.a.Control,{onChange:function(e){s(e.target.value)},as:"textarea",value:n,placeholder:"Message..."}),Object(h.jsx)(y.a.Control.Feedback,{type:"invalid",children:"Please add text to submit a message"}),Object(h.jsx)(C.a,{type:"submit",children:"Submit"})]})},ee=n(51),te=n.n(ee),ne=function(){return Object(h.jsxs)(T.a,{className:te.a.chat,children:[Object(h.jsx)(B,{}),Object(h.jsx)(z,{}),Object(h.jsx)($,{})]})};var ae=function(){var e=Object(u.c)((function(e){return e.login.targetStatus}));return Object(h.jsx)("div",{className:"App",children:"connection"!==e?Object(h.jsx)(G,{}):Object(h.jsx)(ne,{})})},se=(n(71),n(72),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,75)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),c(e),r(e)}))});r.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(u.a,{store:S,children:Object(h.jsx)(p,{children:Object(h.jsx)(ae,{})})})}),document.getElementById("root")),se()}},[[73,1,2]]]);
//# sourceMappingURL=main.28d56c37.chunk.js.map